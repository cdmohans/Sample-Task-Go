{{ define "content" }}   
   <div class="container">
        <div class="form-group">
            <label for="inputQuery">Search Query:</label>
            <input id="inputQuery" type="text" class="form-control" placeholder="Example: &quot;Starbucks&quot;, &quot;coffee&quot;, &quot;pizza&quot; etc.">
        </div>
        <div class="form-group">
            <label for="inputLocation">Location:</label>
            <input id="inputLocation" type="text" class="form-control" placeholder="Example: &quot;Tokyo&quot;, &quot;Japan&quot;, &quot;Singapore&quot;, &quot;Jakarta&quot;, &quot;Raffles Place, Singapore&quot;">
        </div>
        <div class="form-group">
            <button id="buttonSearch" type="button" class="btn btn-primary">Search</button>
        </div>
        <div id="divSearchResults" class="form-group" style="visibility:hidden">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-8">
                    <div class="table-responsive">
                        <table id="data-table" class="table table-striped">
                            <thead>
                                <tr>
                                    <th data-field="name" data-sortable="true">Name</th>
                                    <th data-field="rating" data-sortable="true">Rating</th>
                                    <th data-field="image_url" data-formatter="imageFormatter"></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-4" style="padding-top:30px">
                    <div id="mapcontainer" style="position: relative; z-index: auto; top: 0px; padding-top: 10px;">
                        <div id="map" style="width: 300px; height: 300px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $("#buttonSearch").click(function () {
            $("#divSearchResults").css("visibility", "hidden");
            $.ajax({
                type: "POST",
                url: "http://localhost:8000/SearchBusiness",
                data: JSON.stringify({ term: $("#inputQuery").val(), location: $("#inputLocation").val() }),
                success: function (pData) {
                    $("#divSearchResults").css("visibility", "visible");
                    $('#data-table').bootstrapTable("destroy");
                    $('#data-table').bootstrapTable({ data: pData.businesses });
                    addGoogleMarker(pData.businesses);
                },
                failure: function (errMsg) {
                    alert(errMsg);
                }
            });
        });
        function imageFormatter(value, row) {
            return '<img src="' + value + '" width="100" height="90" />';
        }

        function addGoogleMarker(jsonData) {
            $("#map").googleMap();

            for (var i = 0; i < jsonData.length; i++) {
                $("#map").addMarker({
                    coords: [jsonData[i].coordinates.latitude, jsonData[i].coordinates.longitude],
                    title: jsonData[i].location.address1, id: jsonData[i].id
                });
            }
        }
    </script>
{{ end }}